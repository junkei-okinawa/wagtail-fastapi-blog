# Django + Wagtail + FastAPI Blog - é–‹ç™ºã‚¬ã‚¤ãƒ‰

## ğŸš€ é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶
- Python 3.12+
- uv (Python package manager)
- Git

### åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
```bash
# 1. ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³
git clone <repository-url>
cd my-wagtail-fastapi-blog

# 2. ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
make install

# 3. Pre-commit hooksè¨­å®š
make setup-hooks

# 4. ç’°å¢ƒå¤‰æ•°è¨­å®š
cp .env.example .env
# .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¦APIã‚­ãƒ¼ç­‰ã‚’è¨­å®š

# 5. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
make migrate
make createsuperuser

# 6. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
make dev
```

## ğŸ”§ Makeã‚³ãƒãƒ³ãƒ‰ä¸€è¦§

### **åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰**
| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|---------|------|
| `make help` | åˆ©ç”¨å¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰ä¸€è¦§è¡¨ç¤º |
| `make install` | å…¨ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« |
| `make dev` | é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹• (http://localhost:8000) |

### **ãƒ†ã‚¹ãƒˆé–¢é€£**
| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|---------|------|
| `make test` | å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ |
| `make test-unit` | å˜ä½“ãƒ†ã‚¹ãƒˆã®ã¿å®Ÿè¡Œ |
| `make test-integration` | çµ±åˆãƒ†ã‚¹ãƒˆã®ã¿å®Ÿè¡Œ |
| `make test-e2e` | E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆPlaywrightï¼‰ |
| `make test-coverage` | ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ããƒ†ã‚¹ãƒˆå®Ÿè¡Œ |
| `make test-quick` | é«˜é€Ÿãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆä¸¦åˆ—ï¼‰ |

### **Dockeré–¢é€£**
| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|---------|------|
| `make docker-build` | Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰ |
| `make docker-dev` | é–‹ç™ºç’°å¢ƒèµ·å‹•ï¼ˆSQLiteï¼‰ |
| `make docker-full` | æœ¬æ ¼ç’°å¢ƒèµ·å‹•ï¼ˆPostgreSQL + Redisï¼‰ |
| `make docker-down` | ã‚³ãƒ³ãƒ†ãƒŠåœæ­¢ãƒ»å‰Šé™¤ |
| `make docker-clean` | ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ»ãƒœãƒªãƒ¥ãƒ¼ãƒ å®Œå…¨å‰Šé™¤ |

### **ã‚³ãƒ¼ãƒ‰å“è³ª**
| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|---------|------|
| `make lint` | ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯ (flake8, ruff) |
| `make format` | ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ (black, isort, ruff) |
| `make setup-hooks` | Pre-commit hooks ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« |
| `make check-hooks` | Pre-commit hooks æ‰‹å‹•å®Ÿè¡Œ |

### **Djangoç®¡ç†**
| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|---------|------|
| `make migrate` | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ |
| `make createsuperuser` | ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ |
| `make collectstatic` | é™çš„ãƒ•ã‚¡ã‚¤ãƒ«åé›† |
| `make shell` | Django shellèµ·å‹• |

### **é–‹ç™ºæ”¯æ´**
| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|---------|------|
| `make clean` | ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤ |
| `make logs` | é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚°è¡¨ç¤º |

## ğŸ“ é–‹ç™ºãƒ•ãƒ­ãƒ¼

### **1. æ–°æ©Ÿèƒ½é–‹ç™º**
```bash
# ãƒ–ãƒ©ãƒ³ãƒä½œæˆ
git checkout -b feature/new-feature

# é–‹ç™ºç’°å¢ƒç¢ºèª
make dev

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
make test

# ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯
make lint
make format

# ã‚³ãƒŸãƒƒãƒˆï¼ˆpre-commitè‡ªå‹•å®Ÿè¡Œï¼‰
git add .
git commit -m "feat: æ–°æ©Ÿèƒ½å®Ÿè£…"
```

### **2. ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆå‰ãƒã‚§ãƒƒã‚¯**
```bash
# å…¨ä½“ãƒã‚§ãƒƒã‚¯
make check-hooks
make test-coverage
make lint

# å•é¡Œãªã‘ã‚Œã°ãƒ—ãƒƒã‚·ãƒ¥
git push origin feature/new-feature
```

## ğŸ§ª ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### **ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ**
```
tests/
â”œâ”€â”€ conftest.py              # ãƒ†ã‚¹ãƒˆè¨­å®šãƒ»fixtures
â”œâ”€â”€ unit/                    # å˜ä½“ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_blog_models.py  # ãƒ–ãƒ­ã‚°ãƒ¢ãƒ‡ãƒ«ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_posts_api.py    # æŠ•ç¨¿APIãƒ†ã‚¹ãƒˆ
â”‚   â””â”€â”€ test_payments_api.py # æ±ºæ¸ˆAPIãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ integration/             # çµ±åˆãƒ†ã‚¹ãƒˆ
â”‚   â””â”€â”€ test_full_integration.py
â””â”€â”€ e2e/                     # E2Eãƒ†ã‚¹ãƒˆï¼ˆPlaywrightï¼‰
    â”œâ”€â”€ conftest.py          # E2Eç’°å¢ƒè¨­å®š
    â”œâ”€â”€ test_basic_e2e.py    # åŸºæœ¬å‹•ä½œãƒ†ã‚¹ãƒˆ
    â””â”€â”€ test_blog_e2e.py     # ãƒ–ãƒ­ã‚°æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
```

### **ãƒ†ã‚¹ãƒˆå®Ÿè¡Œãƒ‘ã‚¿ãƒ¼ãƒ³**
```bash
# é–‹ç™ºä¸­ï¼ˆé«˜é€Ÿï¼‰
make test-unit

# æ©Ÿèƒ½å®Œæˆæ™‚ï¼ˆå®Œå…¨ï¼‰
make test

# E2Eãƒ†ã‚¹ãƒˆï¼ˆãƒ–ãƒ©ã‚¦ã‚¶è‡ªå‹•åŒ–ï¼‰
make test-e2e

# ãƒªãƒªãƒ¼ã‚¹å‰ï¼ˆè©³ç´°ï¼‰
make test-coverage
```

### **E2Eãƒ†ã‚¹ãƒˆè©³ç´°**
```bash
# E2Eç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
uv run python scripts/setup_e2e_db.py

# ãƒ–ãƒ©ã‚¦ã‚¶åˆ¥ãƒ†ã‚¹ãƒˆ
make test-e2e  # å…¨ãƒ–ãƒ©ã‚¦ã‚¶
pytest tests/e2e/ --browser=chromium  # Chromeç³»
pytest tests/e2e/ --browser=firefox   # Firefox
pytest tests/e2e/ --browser=webkit    # Safariç³»

# ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹/ãƒ˜ãƒƒãƒ‰ãƒ•ãƒ«ãƒ¢ãƒ¼ãƒ‰
pytest tests/e2e/ --headed           # ãƒ–ãƒ©ã‚¦ã‚¶è¡¨ç¤ºã‚ã‚Š
pytest tests/e2e/ --video=on         # å‹•ç”»è¨˜éŒ²
```

**E2Eç’°å¢ƒã®ç‰¹å¾´:**
- **å°‚ç”¨DB**: `db_e2e.sqlite3`ã§æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ã¨å®Œå…¨åˆ†é›¢
- **CORSå¯¾å¿œ**: å®Ÿéš›ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é€šä¿¡ãƒ†ã‚¹ãƒˆ
- **è‡ªå‹•ã‚µãƒ¼ãƒãƒ¼èµ·å‹•**: ãƒ†ã‚¹ãƒˆé–‹å§‹æ™‚ã«è‡ªå‹•ã§ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ãƒ»åœæ­¢
- **ä¸¦åˆ—å®Ÿè¡Œ**: è¤‡æ•°ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®åŒæ™‚ãƒ†ã‚¹ãƒˆå¯¾å¿œ

## ğŸ³ Dockeré–‹ç™ºç’°å¢ƒ

### **ã‚³ãƒ³ãƒ†ãƒŠæ§‹æˆ**
- **docker-dev**: Django+FastAPIï¼ˆSQLiteï¼‰
- **docker-full**: Django+FastAPI+PostgreSQL+Redis

### **åŸºæœ¬çš„ãªä½¿ã„æ–¹**
```bash
# é–‹ç™ºç’°å¢ƒèµ·å‹•ï¼ˆSQLiteï¼‰
make docker-dev

# æœ¬æ ¼ç’°å¢ƒèµ·å‹•ï¼ˆPostgreSQL + Redisï¼‰
make docker-full

# ã‚³ãƒ³ãƒ†ãƒŠçŠ¶æ³ç¢ºèª
docker ps

# ãƒ­ã‚°ç¢ºèª
docker logs docker-web-1

# ç’°å¢ƒåœæ­¢
make docker-down
```

### **Dockerç’°å¢ƒã®ãƒ¡ãƒªãƒƒãƒˆ**
- ğŸ—ï¸ **ç’°å¢ƒçµ±ä¸€**: ãƒãƒ¼ãƒ å…¨å“¡ã§åŒã˜ç’°å¢ƒ
- ğŸš€ **é«˜é€Ÿèµ·å‹•**: ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸è¦
- ğŸ”’ **éš”é›¢æ€§**: ãƒ›ã‚¹ãƒˆç’°å¢ƒã«å½±éŸ¿ã—ãªã„
- ğŸ“¦ **æœ¬ç•ªåŒç­‰**: PostgreSQL + Redisæ§‹æˆå¯èƒ½

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### **ã‚ˆãã‚ã‚‹å•é¡Œ**

**1. ä¾å­˜é–¢ä¿‚ã‚¨ãƒ©ãƒ¼**
```bash
# ä¾å­˜é–¢ä¿‚å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
uv sync --reinstall
```

**2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼**
```bash
# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–
rm db.sqlite3
make migrate
```

**3. é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼**
```bash
# é™çš„ãƒ•ã‚¡ã‚¤ãƒ«å†åé›†
make collectstatic
```

**4. Pre-commitå¤±æ•—**
```bash
# ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆè‡ªå‹•ä¿®æ­£
make format
git add .
git commit
```

**5. E2Eãƒ†ã‚¹ãƒˆå¤±æ•—**
```bash
# E2Eå°‚ç”¨DBå†ä½œæˆ
uv run python scripts/setup_e2e_db.py

# ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ç¢ºèª
make dev  # åˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§
pytest tests/e2e/test_basic_e2e.py  # åŸºæœ¬ãƒ†ã‚¹ãƒˆã®ã¿
```

**6. Dockerã‚¨ãƒ©ãƒ¼**
```bash
# ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ»ã‚³ãƒ³ãƒ†ãƒŠå®Œå…¨å‰Šé™¤
make docker-clean

# å†ãƒ“ãƒ«ãƒ‰
make docker-build
make docker-dev
```

## ğŸ“Š é–‹ç™ºãƒ¡ãƒˆãƒªã‚¯ã‚¹

### **ç¾åœ¨ã®å®Ÿç¸¾ï¼ˆ2025å¹´6æœˆ15æ—¥æ™‚ç‚¹ï¼‰**
- âœ… **ãƒ†ã‚¹ãƒˆæˆåŠŸç‡**: 100% (41/41ä»¶)
- âœ… **ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸**: 82%
- âœ… **E2Eãƒ†ã‚¹ãƒˆ**: 14ä»¶ï¼ˆå…¨æˆåŠŸï¼‰
- âœ… **ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“**: <100ms
- âœ… **ã‚¨ãƒ©ãƒ¼ç‡**: 0%
- âœ… **Lint**: å…¨ã‚¨ãƒ©ãƒ¼è§£æ¶ˆæ¸ˆã¿

### **å“è³ªåŸºæº–**
| æŒ‡æ¨™ | æœ€ä½åŸºæº– | æ¨å¥¨åŸºæº– | ç¾åœ¨å€¤ |
|------|----------|----------|---------|
| ãƒ†ã‚¹ãƒˆæˆåŠŸç‡ | 95% | 100% | **100%** âœ… |
| ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸ | 70% | 80%+ | **82%** âœ… |
| E2Eãƒ†ã‚¹ãƒˆ | 5ä»¶ | 10ä»¶+ | **14ä»¶** âœ… |
| Lint ã‚¨ãƒ©ãƒ¼ | 0 | 0 | **0** âœ… |

## ğŸ”— é–¢é€£ãƒªãƒ³ã‚¯

### **é–‹ç™ºç’°å¢ƒ**
- **é–‹ç™ºã‚µãƒ¼ãƒãƒ¼**: http://localhost:8000
- **Djangoç®¡ç†ç”»é¢**: http://localhost:8000/django-admin/
- **Wagtail CMS**: http://localhost:8000/admin/
- **FastAPIä»•æ§˜æ›¸**: http://localhost:8000/docs
- **OpenAPI JSON**: http://localhost:8000/openapi.json

### **API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**
- **ãƒ–ãƒ­ã‚°æŠ•ç¨¿API**: http://localhost:8000/api/posts/
- **æ±ºæ¸ˆAPI**: http://localhost:8000/api/payments/
- **ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯**: http://localhost:8000/api/posts/health

### **é–‹ç™ºãƒ„ãƒ¼ãƒ«**
- **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆ**: ./htmlcov/index.html
- **E2E ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆ**: ./test-results/
- **ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«**: ./django_project/logs/

### **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«**
- **Djangoè¨­å®š**: `django_project/totonoe_template/settings/`
- **E2Eè¨­å®š**: `tests/e2e/conftest.py`
- **Dockerè¨­å®š**: `docker/`
- **å“è³ªç®¡ç†**: `.pre-commit-config.yaml`

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

é–‹ç™ºç’°å¢ƒãŒæ•´ã£ãŸã‚‰ã€ä»¥ä¸‹ã®ã‚¿ã‚¹ã‚¯ã«å–ã‚Šçµ„ã‚€ã“ã¨ãŒã§ãã¾ã™ï¼š

1. **æ–°æ©Ÿèƒ½é–‹ç™º**: `ROADMAP.md`å‚ç…§
2. **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸å‘ä¸Š**: æœªã‚«ãƒãƒ¼éƒ¨åˆ†ã®ç‰¹å®šãƒ»ãƒ†ã‚¹ãƒˆè¿½åŠ 
3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**: ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ãƒ»ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡æ”¹å–„
4. **CI/CDå°å…¥**: GitHub Actionsè¨­å®š
5. **æœ¬ç•ªç’°å¢ƒæº–å‚™**: PostgreSQLç§»è¡Œãƒ»ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤

## ğŸ› å•é¡Œå ±å‘Šãƒ»ææ¡ˆ

é–‹ç™ºä¸­ã«å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã‚„æ”¹å–„ææ¡ˆãŒã‚ã‚‹å ´åˆã¯ã€é©åˆ‡ãªissue templateã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ï¼š

- ğŸ› **ãƒã‚°å ±å‘Š**: [Bug Report Template](../../issues/new?template=bug_report.md)
- âœ¨ **æ–°æ©Ÿèƒ½ææ¡ˆ**: [Feature Request Template](../../issues/new?template=feature_request.md)  
- âš¡ **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œ**: [Performance Issue Template](../../issues/new?template=performance_issue.md)
- ğŸ”’ **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§**: [Security Template](../../issues/new?template=security_vulnerability.md)

è©³ç´°ã¯ `CONTRIBUTING.md` ã¨ `ROADMAP.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
